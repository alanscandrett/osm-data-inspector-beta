(function(t){function e(e){for(var r,i,u=e[0],s=e[1],c=e[2],p=0,d=[];p<u.length;p++)i=u[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,u=1;u<n.length;u++){var s=n[u];0!==o[s]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={app:0},a=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var c=0;c<u.length;c++)e(u[c]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"04d7":function(t,e,n){},1:function(t,e){},"15cc":function(t,e,n){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Map")],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"MapView"},[n("LMap",{ref:"LeafletMap",attrs:{zoom:t.zoom,center:t.center}},[n("LTileLayer",{attrs:{url:t.url}}),n("LFeatureGroup",{ref:"SketchLayer",on:{ready:function(e){return t.addControls()}}}),n("MapButton",{attrs:{unicodeSymbol:t.chartIcon}},[n("StatisticsPanel",{attrs:{buildingsCount:t.buildingStatistics.buildingsCount,buildingsLandUse:t.buildingStatistics.buildingsLandUse}})],1)],1)],1)},u=[],s=(n("99af"),n("4de4"),n("4160"),n("d81d"),n("b0c0"),n("b680"),n("b64b"),n("159b"),n("96cf"),n("1da1")),c=n("2699"),l=n("a40a"),p=n("c5ca"),d=n("b6e3"),f=n.n(d),y={osm:function(t,e,n){f()(t,e,n)}},g=y,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("l-control",{class:t.cssClassName,attrs:{position:"topleft"}},[n("div",{on:{click:t.toggleOpen}},[t.isOpen?t._t("default"):n("div",{staticClass:"icon"},[t._v(t._s(t.unicodeSymbol))])],2)])},b=[],m=n("2253"),v={name:"MapButton",components:{LControl:m["a"]},props:{cssClassName:{type:String,default:"example-custom-control"},unicodeSymbol:{type:String,default:"â˜¹"}},data:function(){return{isOpen:!1}},methods:{toggleOpen:function(){this.isOpen=!this.isOpen}}},L=v,O=(n("f973"),n("2877")),_=Object(O["a"])(L,h,b,!1,null,"775962ef",null),S=_.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"PanelParent"},[t._m(0),n("div",[n("table",[t._m(1),n("tr",[n("td",[t._v(t._s(t.buildingsCount))]),n("td",[t._v(t._s(t.buildingsLandUse))])])])])])},w=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",[t._v("Structure Statistics")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th",[t._v("Building Count")]),n("th",[t._v("Building Area %")])])}],A=(n("a9e3"),{name:"StatisticsPanel",components:{},props:{buildingsCount:{type:Number,default:0},buildingsLandUse:{type:Number,default:0}}}),M=A,j=(n("799a"),Object(O["a"])(M,P,w,!1,null,"8fbdd6a8",null)),C=j.exports,x=n("e11e"),N=n.n(x),k=(n("20d6"),n("5fbf"),n("595b")),F=n("b196"),q={name:"Map",components:{LMap:c["a"],LTileLayer:l["a"],LFeatureGroup:p["a"],MapButton:S,StatisticsPanel:C},data:function(){return{chartIcon:"ðŸ“Š",url:"https://cdn.lima-labs.com/{z}/{x}/{y}.png?free",zoom:15,center:[35.67319515681665,139.74308967590332],buildingLayers:[],queryPolygonLayers:[],buildingFootprintArea:void 0,queryPolygonArea:void 0}},computed:{map:function(){return this.$refs.LeafletMap.mapObject},sketchLayer:function(){return this.$refs.SketchLayer},buildingStatistics:function(){var t={buildingsCount:void 0,buildingsLandUse:void 0};return this.buildingFootprintArea&&this.queryPolygonArea&&(t.buildingsCount=Object.keys(this.buildingLayers[0]._layers).length,t.buildingsLandUse=this.buildingFootprintArea/this.queryPolygonArea*100),t}},mounted:function(){var t=this;this.map.on("draw:created",(function(e){var n=t.queryPolygonLayers.pop();n&&n.remove(),t.queryPolygonLayers.push(e.layer),t.map.addLayer(e.layer),t.buildingFootprintArea=0,t.queryPolygonArea=0,t.getGeometry()}))},methods:{getArea:function(t){var e=k["polygon"](t);return k["area"](e)},addControls:function(){var t=new N.a.Control.Draw({draw:{polyline:!1,circle:!1,circlemarker:!1,marker:!1},edit:{featureGroup:this.$refs.SketchLayer.mapObject,edit:!1,remove:!1}});this.map.addControl(t)},getGeometry:function(){var t=this.queryPolygonLayers[0].toGeoJSON();this.queryPolygonArea=this.getArea(t.geometry.coordinates),this.spatialQueryOSM(t.geometry.coordinates)},addGeoJSONtoMap:function(t,e){var n=this;this.buildingLayers.length&&this.buildingLayers.pop().remove(),e.features=e.features.map((function(t){if("Polygon"===t.geometry.type){var e=F(t,n.queryPolygonLayers[0].toGeoJSON());return e.features[0].properties=t.properties,e.features[0].id=t.id,e}})),e.features=e.features.filter((function(t){return void 0!=t}));var r=N.a.geoJson(e,{onEachFeature:function(t,e){var n="N/A",r=t.properties.id?t.properties.id:n,o=t.properties.name?t.properties.name:n,a=t.properties["name:en"]?t.properties["name:en"]:n,i=t.properties["operator:en"]?t.properties["operator:en"]:n,u=t.properties.height?t.properties.height:n,s=t.properties.source?t.properties.source:n,c=t.properties.amenity?t.properties.amenity:n;e.bindPopup("\n          <h1> Building Details </h1>\n          <table>\n            <tr>\n              <th>ID</td>\n              <th>Name</td>\n              <th>Name (EN)</td>\n              <th>Operator</td>\n              <th>Height</td>\n              <th>Source</td>\n              <th>Amenity</td>\n            </tr>\n            <tr>\n              <td>".concat(r,"</td>\n              <td>").concat(o,"</td>\n              <td>").concat(a,"</td>\n              <td>").concat(i,"</td>\n              <td>").concat(u,"</td>\n              <td>").concat(s,"</td>\n              <td>").concat(c,"</td>\n            </tr>\n          </table>\n          "),{maxWidth:"auto",className:"popupClass"})}});this.buildingLayers.push(r),r.addTo(this.map),this.calculateBuildingFootprintArea()},spatialQueryOSM:function(t){var e="";t[0].forEach((function(t){e+=" "+t[1]+" "+t[0]}));var n='[out:json];\n        way[building](poly:"'.concat(e,'");\n        (._;>;);\n        out;');g.osm(n,this.addGeoJSONtoMap,{flatProperties:!0})},calculateBuildingFootprintArea:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=0,r=t.buildingLayers[0].getLayers(),r.forEach((function(e){if("Polygon"===e.feature.geometry.type){var r=t.getArea(e.feature.geometry.coordinates);n+=r}})),t.buildingFootprintArea=parseFloat(n.toFixed(2));case 4:case"end":return e.stop()}}),e)})))()}}},E=q,U=(n("eb6f"),Object(O["a"])(E,i,u,!1,null,null,null)),$=U.exports,G={name:"App",components:{Map:$}},B=G,J=(n("5c0b"),Object(O["a"])(B,o,a,!1,null,null,null)),I=J.exports;n("6cc5");r["a"].config.productionTip=!1,delete x["Icon"].Default.prototype._getIconUrl,x["Icon"].Default.mergeOptions({iconRetinaUrl:n("584d"),iconUrl:n("6397"),shadowUrl:n("e2b9")}),new r["a"]({render:function(t){return t(I)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"799a":function(t,e,n){"use strict";n("04d7")},"9c0c":function(t,e,n){},a61a:function(t,e,n){},eb6f:function(t,e,n){"use strict";n("15cc")},f973:function(t,e,n){"use strict";n("a61a")}});
//# sourceMappingURL=app.e0f7c813.js.map