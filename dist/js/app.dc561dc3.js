(function(e){function t(t){for(var r,i,u=t[0],s=t[1],c=t[2],d=0,p=[];d<u.length;d++)i=u[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(p.length)p.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,u=1;u<n.length;u++){var s=n[u];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"04d7":function(e,t,n){},1:function(e,t){},2:function(e,t){},"241a":function(e,t,n){"use strict";n("5ef3")},3:function(e,t){},4:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Map")],1)},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"MapView"},[n("LMap",{ref:"LeafletMap",attrs:{zoom:e.zoom,center:e.center}},[n("LTileLayer",{attrs:{url:e.url}}),n("LFeatureGroup",{ref:"SketchLayer",on:{ready:function(t){return e.addControls()}}}),n("MapButton",{attrs:{unicodeSymbol:e.chartIcon}},[n("StatisticsPanel",{attrs:{buildingsCount:e.buildingStatistics.buildingsCount,buildingsLandUse:e.buildingStatistics.buildingsLandUse}})],1)],1)],1)},u=[],s=(n("4de4"),n("4160"),n("d81d"),n("b680"),n("b64b"),n("159b"),n("96cf"),n("1da1")),c=n("2699"),l=n("a40a"),d=n("c5ca"),p=n("b6e3"),f=n.n(p),y={osm:function(e,t,n){f()(e,t,n)}},g=y,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("l-control",{class:e.cssClassName},[n("div",{on:{click:e.toggleOpen}},[e.isOpen?e._t("default"):n("div",{staticClass:"icon"},[e._v(e._s(e.unicodeSymbol))])],2)])},h=[],m=n("2253"),v={name:"MapButton",components:{LControl:m["a"]},props:{cssClassName:{type:String,default:"example-custom-control"},unicodeSymbol:{type:String,default:"â˜¹"}},data:function(){return{isOpen:!1}},methods:{toggleOpen:function(){this.isOpen=!this.isOpen}}},L=v,_=(n("628f"),n("2877")),O=Object(_["a"])(L,b,h,!1,null,"1e5a39d3",null),S=O.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"PanelParent"},[e._m(0),n("div",[n("table",[e._m(1),n("tr",[n("td",[e._v(e._s(e.buildingsCount))]),n("td",[e._v(e._s(e.buildingsLandUse))])])])])])},w=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Structure Statistics")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("th",[e._v("Building Count")]),n("th",[e._v("Building Area %")])])}],M=(n("a9e3"),{name:"StatisticsPanel",components:{},props:{buildingsCount:{type:Number,default:0},buildingsLandUse:{type:Number,default:0}}}),j=M,A=(n("799a"),Object(_["a"])(j,P,w,!1,null,"8fbdd6a8",null)),C=A.exports,x=n("e11e"),k=n.n(x),F=(n("20d6"),n("5fbf"),n("595b")),q=n("b196"),U={name:"Map",components:{LMap:c["a"],LTileLayer:l["a"],LFeatureGroup:d["a"],MapButton:S,StatisticsPanel:C},data:function(){return{chartIcon:"ðŸ— ",url:"https://cdn.lima-labs.com/{z}/{x}/{y}.png?free",zoom:15,center:[35.67319515681665,139.74308967590332],buildingLayers:[],queryPolygonLayers:[],buildingFootprintArea:void 0,queryPolygonArea:void 0}},computed:{map:function(){return this.$refs.LeafletMap.mapObject},sketchLayer:function(){return this.$refs.SketchLayer},buildingStatistics:function(){var e={buildingsCount:void 0,buildingsLandUse:void 0};return this.buildingFootprintArea&&this.queryPolygonArea&&(e.buildingsCount=Object.keys(this.buildingLayers[0]._layers).length,e.buildingsLandUse=this.buildingFootprintArea/this.queryPolygonArea*100),e}},mounted:function(){var e=this;this.map.on("draw:created",(function(t){var n=e.queryPolygonLayers.pop();n&&n.remove(),e.queryPolygonLayers.push(t.layer),e.map.addLayer(t.layer),e.buildingFootprintArea=0,e.queryPolygonArea=0,e.getGeometry()}))},methods:{getArea:function(e){var t=F["polygon"](e);return F["area"](t)},addControls:function(){var e=new k.a.Control.Draw({draw:{polyline:!1,circle:!1,circlemarker:!1,marker:!1},edit:{featureGroup:this.$refs.SketchLayer.mapObject,edit:!1,remove:!1}});this.map.addControl(e)},getGeometry:function(){var e=this.queryPolygonLayers[0].toGeoJSON();this.queryPolygonArea=this.getArea(e.geometry.coordinates),this.spatialQueryOSM(e.geometry.coordinates)},addGeoJSONtoMap:function(e,t){var n=this;this.buildingLayers.length&&this.buildingLayers.pop().remove(),t.features=t.features.map((function(e){if("Polygon"===e.geometry.type){var t=q(e,n.queryPolygonLayers[0].toGeoJSON());return t.properties=e.properties,t}})),t.features=t.features.filter((function(e){return void 0!=e})),console.log(t.features);var r=k.a.geoJson(t);this.buildingLayers.push(r),r.addTo(this.map),this.calculateBuildingFootprintArea()},spatialQueryOSM:function(e){var t="";e[0].forEach((function(e){t+=" "+e[1]+" "+e[0]}));var n='[out:json];\n        way[building](poly:"'.concat(t,'");\n        (._;>;);\n        out;');g.osm(n,this.addGeoJSONtoMap,{flatProperties:!0})},calculateBuildingFootprintArea:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0,r=e.buildingLayers[0].getLayers(),r.forEach((function(t){if("Polygon"===t.feature.geometry.type){var r=e.getArea(t.feature.geometry.coordinates);n+=r}})),e.buildingFootprintArea=parseFloat(n.toFixed(2));case 4:case"end":return t.stop()}}),t)})))()}}},$=U,G=(n("241a"),Object(_["a"])($,i,u,!1,null,"2b81c480",null)),E=G.exports,N={name:"App",components:{Map:E}},B=N,J=(n("5c0b"),Object(_["a"])(B,o,a,!1,null,null,null)),T=J.exports;n("6cc5");r["a"].config.productionTip=!1,delete x["Icon"].Default.prototype._getIconUrl,x["Icon"].Default.mergeOptions({iconRetinaUrl:n("584d"),iconUrl:n("6397"),shadowUrl:n("e2b9")}),new r["a"]({render:function(e){return e(T)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"5ef3":function(e,t,n){},"628f":function(e,t,n){"use strict";n("c949")},"799a":function(e,t,n){"use strict";n("04d7")},"9c0c":function(e,t,n){},c949:function(e,t,n){}});
//# sourceMappingURL=app.dc561dc3.js.map